
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Summary &#8212; Estimating Covariance Structures and Generalised Least Squares</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/test.css?v=a80109f0" />
    <link rel="stylesheet" type="text/css" href="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rgl.css?v=57907efa" />
    <link rel="stylesheet" type="text/css" href="_static/sphericity_3d_files/htmltools-fill-0.5.8.1/fill.css?v=971cc1da" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'summary';</script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/textures.src.js?v=9482728f"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/shadersrc.src.js?v=6ce05c17"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/buffer.src.js?v=1efca185"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/mouse.src.js?v=96f0b970"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/projection.src.js?v=98871b91"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/axes.src.js?v=3250d244"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rglTimer.src.js?v=ac1c3151"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/pretty.src.js?v=4f2cffba"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/shaders.src.js?v=bbbdf37d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/animation.src.js?v=74f9b9e8"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/pieces.src.js?v=280fd571"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/selection.src.js?v=5b47ed7d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/init.src.js?v=f5bdcbbb"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/subscenes.src.js?v=42cb429d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/controls.src.js?v=4b3dbe6f"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/draw.src.js?v=49d9cbaa"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/utils.src.js?v=56efe719"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rglClass.src.js?v=9e593197"></script>
    <script src="_static/sphericity_3d_files/rglWebGL-binding-1.3.18/rglWebGL.js?v=8cd6f6d7"></script>
    <script src="_static/sphericity_3d_files/htmlwidgets-1.6.4/htmlwidgets.js?v=175713be"></script>
    <script src="_static/sphericity_3d_files/CanvasMatrix4-1.3.18/CanvasMatrix.src.js?v=5a2d04be"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Using GLS in R" href="4.gls-R.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Estimating Covariance Structures and Generalised Least Squares - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Estimating Covariance Structures and Generalised Least Squares - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.estimating-sigma.html">Estimating Covariance Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.covariance-solutions.html">Solutions for Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.gls.html">Generalised Least Squares (GLS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.gls-R.html">Using GLS in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/estimating-covariance-gls" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/estimating-covariance-gls/issues/new?title=Issue%20on%20page%20%2Fsummary.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/summary.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Summary</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-limitations">Practical Limitations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conceptual-limitations">Conceptual Limitations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-should-we-use-gls">When Should We Use GLS?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h1>
<p>We have spent a lot of time in this lesson discussing GLS. Although you may be wondering <em>why</em>, given that this unit is about <em>mixed-effects</em>, focusing on GLS to begin with has several advantages:</p>
<ul class="simple">
<li><p>Many problems you encounter in practice may be more simply addressed by using GLS, rather than a full mixed-effects approach.</p></li>
<li><p>GLS very directly solves our main issues with the traditional repeated measures ANOVA, and so is the logical <em>next step</em> away from those methods.</p></li>
<li><p>GLS makes us focus on the idea of the <em>covariance structure</em>, which is helpful for conceptualising how to model repeated measures, as well as understanding mixed-effects.</p></li>
<li><p>In terms of implementation, the syntax used by <code class="docutils literal notranslate"><span class="pre">gls()</span></code> for describing the covariance structure will be repurposed in the context of mixed-effects. So understanding it now is very useful.</p></li>
<li><p>Mixed-effects models can be understood as a <em>form</em> of GLS, so conceptually GLS is a good starting point.</p></li>
<li><p>The issues around inference are not <em>unique</em> to GLS, as they are also shared by mixed-effects models. So understanding these problems <em>from the start</em> will prevent confusion later.</p></li>
</ul>
<p>However, as we have seen, there are some <em>problems</em> with using GLS. Some of these problems are <em>practical limitations</em> based on how GLS is implemented in <code class="docutils literal notranslate"><span class="pre">R</span></code>. These types of problems are potentially <em>fixable</em> in software, but are not presently implemented. Alternatively, some of these problems are <em>conceptual</em> and apply irrespective of any specific implementation in software.</p>
<p>In terms of justifying the move to <em>mixed-effects</em>, the bigger issues are the <em>conceptual</em> ones. Although there may be a <em>practical</em> reason for moving to a different framework, this is not wholly convincing when the problem is a <em>software</em> one. Instead, we need to consider more fundamental <em>conceptual</em> limitations that justify a <em>more flexible</em> framework. So, the argument is <em>not</em> that mixed-effects models suddenly solve the problem of inference for arbitrary covariance structures (they very much <em>do not</em>). The argument is that the whole <em>framework</em> of mixed-effects provides us with more sophisticated and flexible models that give us everything GLS does <em>and more</em>.</p>
<section id="practical-limitations">
<h2>Practical Limitations<a class="headerlink" href="#practical-limitations" title="Link to this heading">#</a></h2>
<p>In terms of the <em>practical</em> limitations of the <code class="docutils literal notranslate"><span class="pre">gls()</span></code> function, perhaps the biggest is that the function itself is designed to behave as if we are using GLS, not FGLS. This is a problem because, of all the solutions discussed, this is the <em>least desirable</em>. This is further complicated by other functions that are compatible with <code class="docutils literal notranslate"><span class="pre">gls()</span></code> taking a <em>different</em> approach. For instance, because <code class="docutils literal notranslate"><span class="pre">Anova()</span></code> refuses to pretend that we are using GLS, it chooses to fall-back on <em>asymptotic</em> inference. However, because <code class="docutils literal notranslate"><span class="pre">Anova()</span></code> has no other options, we end up forced into using asymptotics elsewhere in order to keep the inferential framework consistent. This is a <em>choice</em> on the part of the <code class="docutils literal notranslate"><span class="pre">car</span></code> developers, because it <em>would</em> be possible for <code class="docutils literal notranslate"><span class="pre">Anova()</span></code> to implement <em>effective degrees of freedom</em> for <code class="docutils literal notranslate"><span class="pre">gls()</span></code> models. But it does not. So, these are not necessarily limitations of the FGLS <em>framework</em>. They are limitations based on the <em>choices</em> made when different authors implemented different solutions in <code class="docutils literal notranslate"><span class="pre">R</span></code>. Although someone could quite easily implement a different package that provides different GLS functionality, the <code class="docutils literal notranslate"><span class="pre">gls()</span></code> function from <code class="docutils literal notranslate"><span class="pre">nlme</span></code> is so ubiquitous and so widely-supported by other packages that this would take time to gain traction and become practically useful. So, for now, it makes most sense to simply treat <code class="docutils literal notranslate"><span class="pre">gls()</span></code> as the only option and thus we must manoeuver around these choices as best we can.</p>
<div class="info admonition">
<p class="admonition-title">A Limitation of R?</p>
<p>Disagreements across packages in terms of how certain facilities are implemented is an unfortunate consequence of the way that <code class="docutils literal notranslate"><span class="pre">R</span></code> works. Because there is no central authority declaring that we will “always use asymptotics”, or “always use effective degrees of freedom”, it becomes up to the developers to decide which methods they want to support. Some developers are less opinionated and want to provide <em>many options</em>, whereas other are <em>very</em> opinionated and want to provide only <em>some</em> options. Although this can be frustrating, you need to remember that these disagreements are not based on <em>nothing</em>. If there were a single solution that had no issues, there would be no controversy. The very fact that there is no consensus actually tells you something <em>very important</em>. If we were to just use something like SPSS, we can absolve responsibility because we have no choice. We just did what SPSS told us! However, this provides an illusion of <em>certainty</em> that is simply not there. For good or for ill, controversies in statistics turn into disagreements across <code class="docutils literal notranslate"><span class="pre">R</span></code> packages. This can be <em>frustrating</em> for users, but the frustration needs to be directed to the right place. It is not the developers’ fault that the sampling distribution is <em>unknown</em>. So, there is often a <em>deeper</em> reason for these problems that can reveal important truths about the methods we are relying on. The naive researcher may cry foul and shout “I just want some <span class="math notranslate nohighlight">\(p\)</span>-values!”. The correct response is not to make the decision for them, it is to ask “which <span class="math notranslate nohighlight">\(p\)</span>-values do you want and are you sure you can trust them?”</p>
</div>
</section>
<section id="conceptual-limitations">
<h2>Conceptual Limitations<a class="headerlink" href="#conceptual-limitations" title="Link to this heading">#</a></h2>
<p>Moving on to the more pressing <em>conceptual</em> limitations, one of the bigger <em>drawbacks</em> to GLS is its <em>simplicity</em>. Now, this is not necessarily a bad thing as there are times when we <em>want</em> (or even <em>need</em>) simplicity. However, simplicity makes it much more difficult, or even impossible, to represent complex situations within the GLS framework. Remember, GLS simply treats the covariance structure as a <em>nuisance</em>. It is a separate element of the model that we simply want to get rid of. We just take a single covariance matrix and sweep it away using a big mathematical broom. But this is an <em>extreme</em> approach to the problem because it <em>ignores</em> the structure that caused the correlation in the first place. In effect, GLS says “we do not care above explaining the dependency structure, we just know that it is there and we want it <em>gone</em>”. GLS takes a <em>sledgehammer</em> to the problem. Sometimes a sledgehammer is the best tool for the job, and sometimes we want something more elegant that can capture more subtle nuances of our data. This requires the model to <em>know</em> how the data are structured so that the models knows <em>where</em> the correlation actually comes from. This is precisely what mixed-effects models do.</p>
<p>If we go back to the beginning of all this discussion about dependency, you should remember that the correlation structure exists <em>as a consequence</em> of how the data is structured. We have datapoints that share a commonality because they come from the same subject. The correlation is therefore a <em>byproduct</em> of this structure. As such, if our model somehow <em>embedded</em> this structure, the correlations would be accounted for <em>automatically</em> without any explicit declaration of the form of the variance-covariance matrix. So rather than reasoning about the precise form of this matrix, we simply state the structure of the data and leave the rest up to the model. This is much more elegant than simply guessing the covariance structure, estimating it and then removing it. Furthermore, the model can use the data structure to its advantage. Information could be pooled to provide much more subtle and nuanced predictions that understands the hierarchy under which the data were sampled. This is not something that GLS is capable of doing, but is <em>precisely</em> what mixed-effects models are able to do. So far from solving the inferential problems of GLS, mixed-effects models actually provide a more sophisticated alternative that does not require us to focus on the covariance structure as an explicit element of the model. We simply express how the data are structured, and everything else is taken care of.</p>
</section>
<section id="when-should-we-use-gls">
<h2>When Should We Use GLS?<a class="headerlink" href="#when-should-we-use-gls" title="Link to this heading">#</a></h2>
<p>So, taking everything we have discussed in this lesson, our final question is: when should we use GLS? Answering this is somewhat tricky when we have not covered mixed-effects as the alternative. However, even at this stage, we can provide recommendations around when GLS may be the <em>better</em> choice. Oftentimes, if you have a repeated measures or longitudinal dataset, you can start by <em>considering</em> GLS and then asking whether mixed-effects actually offers any advantages. If it does not, or if the additional complications that arise from a mixed-effects model do not seem worth it, then GLS is the obvious solution. So, we can conceptualise GLS as something of a <em>fall-back</em> position. However, this does the method something of a disservice as there are plenty of situations where GLS is the more obvious choice:</p>
<ol class="arabic simple">
<li><p>When we have repeated measurements, but no additional structure to the data. For instance, a single time-series from a single subject measured using approaches such as eye-tracking, EEG or fMRI.</p></li>
<li><p>When we genuinely only have a single value per-subject and per-repeated measurement. In these cases, mixed-effects do not have enough variation to work with and will implicitly rely on a very simple covariance structure. If we want an unconstrained covariance structure, we need to use GLS.</p></li>
<li><p>If we really do not care about <em>where</em> the dependency comes from and just want the simplest approach to removing it.</p></li>
</ol>
<p>In a way, GLS can serve as the most straightforward plug-in replacement for the repeated measures ANOVA. It effectively does what the repeated measures ANOVA tries to do, but in a much more flexible way. So, if you have very basic data from a simple repeated measures experiment, GLS is often <em>all you need</em>. However, if you have more sophisticated data with multiple replications per-subject and per-repeated measurement and you want the model to combine all this information in a way that is difficult to conceptualise as a single covariance matrix, mixed-effects are the way to go.</p>
<p>An example might make this clearer. Imagine a study where you are taking multiple measures from each student across different classes and across different schools. We can imagine that the repeated measures from a single student will be correlated, but so too could measures taken from students <em>in the same class</em>. Furthermore, all classes <em>from the same school</em> may well share some element that makes them correlated. So the different schools are all <em>independent</em>, but classes from within the school, students from the same class and measurements from the same student will all be <em>dependent</em>. So how would we express this complex dependency structure as a single covariance matrix? Do you think you could write this down? Do you think you could tell <code class="docutils literal notranslate"><span class="pre">gls()</span></code> how to construct this? Using a mixed-effects approach, we simply embed this hierarchy of measurement in the model and the model will create the covariance structure automatically. We do not even need to think about it. So this is where mixed-effects have a <em>real advantage</em>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="4.gls-R.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Using GLS in <code class="docutils literal notranslate"><span class="pre">R</span></code></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-limitations">Practical Limitations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conceptual-limitations">Conceptual Limitations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-should-we-use-gls">When Should We Use GLS?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>